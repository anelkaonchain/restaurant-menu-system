(()=>{"use strict";const e=window.React,t=window.wp.element,r=function(){const[t,r]=(0,e.useState)([]),[n,o]=(0,e.useState)(!0),[a,l]=(0,e.useState)("today");(0,e.useEffect)(()=>{console.log("ReportsApp mounted!"),i()},[]);const i=async()=>{try{const e=new FormData;e.append("action","rms_get_orders"),e.append("nonce",window.rmsAdmin.nonce);const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e}),n=await t.json();console.log("Orders data:",n),n.success&&r(n.data),o(!1)}catch(e){console.error("Error fetching orders:",e),o(!1)}},d=(e=>{const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());return e.filter(e=>{const t=new Date(e.created_at);if("today"===a)return t>=r;if("week"===a){const e=new Date(r);return e.setDate(e.getDate()-7),t>=e}if("month"===a){const e=new Date(r);return e.setMonth(e.getMonth()-1),t>=e}if("6months"===a){const e=new Date(r);return e.setMonth(e.getMonth()-6),t>=e}if("year"===a){const e=new Date(r);return e.setFullYear(e.getFullYear()-1),t>=e}return!0})})(t),s=d.reduce((e,t)=>e+parseFloat(t.total_price||0),0),p=d.length>0?s/d.length:0,c={pending:d.filter(e=>"pending"===e.status).length,preparing:d.filter(e=>"preparing"===e.status).length,ready:d.filter(e=>"ready"===e.status).length,delivered:d.filter(e=>"delivered"===e.status).length,cancelled:d.filter(e=>"cancelled"===e.status).length},g={};d.forEach(e=>{Array.isArray(e.items)&&e.items.forEach(e=>{g[e.name]||(g[e.name]={name:e.name,quantity:0,revenue:0}),g[e.name].quantity+=parseInt(e.quantity||0),g[e.name].revenue+=parseFloat(e.price||0)*parseInt(e.quantity||0)})});const m=Object.values(g).sort((e,t)=>t.quantity-e.quantity).slice(0,5),x={};d.forEach(e=>{x[e.table_number]||(x[e.table_number]={orders:0,revenue:0}),x[e.table_number].orders+=1,x[e.table_number].revenue+=parseFloat(e.total_price||0)});const y=Object.entries(x).map(([e,t])=>({table:e,...t})).sort((e,t)=>t.revenue-e.revenue).slice(0,5);return n?(0,e.createElement)("div",{style:{padding:"60px 20px",textAlign:"center"}},(0,e.createElement)("div",{style:{display:"inline-block",width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #004E89",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,e.createElement)("p",{style:{marginTop:"20px",color:"#6C757D"}},"Loading Reports..."),(0,e.createElement)("style",null,"@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }")):(0,e.createElement)("div",{style:{padding:"30px",maxWidth:"1400px",margin:"0 auto",backgroundColor:"#F8F9FA",minHeight:"100vh"}},(0,e.createElement)("div",{style:{marginBottom:"30px"}},(0,e.createElement)("h1",{style:{margin:"0 0 20px 0",fontSize:"32px",fontWeight:"700",color:"#2C3E50"}},"📊 Reports & Analytics"),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"15px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",display:"flex",gap:"15px",flexWrap:"wrap"}},["today","week","month","6months","year","all"].map(t=>(0,e.createElement)("button",{key:t,onClick:()=>l(t),style:{padding:"10px 20px",backgroundColor:a===t?"#004E89":"white",color:a===t?"white":"#2C3E50",border:a===t?"none":"2px solid #E9ECEF",borderRadius:"10px",cursor:"pointer",fontSize:"15px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:a===t?"0 4px 12px rgba(0,78,137,0.3)":"none"},onMouseEnter:e=>{a!==t&&(e.target.style.backgroundColor="#F8F9FA",e.target.style.transform="translateY(-2px)")},onMouseLeave:e=>{a!==t&&(e.target.style.backgroundColor="white",e.target.style.transform="none")}},"today"===t&&"📅 Today","week"===t&&"📆 Last 7 Days","month"===t&&"🗓️ Last 30 Days","6months"===t&&"📊 Last 6 Months","year"===t&&"📈 Last Year","all"===t&&"🌍 All Time")))),(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px",marginBottom:"30px"}},(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"25px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:"6px solid #06A77D"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"💰 Total Revenue"),(0,e.createElement)("div",{style:{fontSize:"32px",fontWeight:"800",color:"#06A77D"}},"$",s.toFixed(2))),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"25px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:"6px solid #004E89"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"📋 Total Orders"),(0,e.createElement)("div",{style:{fontSize:"32px",fontWeight:"800",color:"#004E89"}},d.length)),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"25px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:"6px solid #FF6B35"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"📊 Average Order"),(0,e.createElement)("div",{style:{fontSize:"32px",fontWeight:"800",color:"#FF6B35"}},"$",p.toFixed(2))),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"25px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:"6px solid #DC3545"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"❌ Cancelled Orders"),(0,e.createElement)("div",{style:{fontSize:"32px",fontWeight:"800",color:"#DC3545"}},c.cancelled))),(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(500px, 1fr))",gap:"20px"}},(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"25px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)"}},(0,e.createElement)("h3",{style:{marginBottom:"20px",color:"#2C3E50",fontSize:"20px",fontWeight:"700"}},"📈 Order Status Distribution"),(0,e.createElement)("div",{style:{display:"grid",gap:"10px"}},Object.entries(c).map(([t,r])=>{const n={pending:"#FF6B35",preparing:"#004E89",ready:"#06A77D",delivered:"#6C757D",cancelled:"#DC3545"},o=d.length>0?(r/d.length*100).toFixed(1):0;return(0,e.createElement)("div",{key:t},(0,e.createElement)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"}},(0,e.createElement)("span",{style:{textTransform:"capitalize",fontWeight:"600",fontSize:"14px"}},t),(0,e.createElement)("span",{style:{fontWeight:"700",color:n[t]}},r," (",o,"%)")),(0,e.createElement)("div",{style:{height:"10px",backgroundColor:"#E9ECEF",borderRadius:"5px",overflow:"hidden"}},(0,e.createElement)("div",{style:{width:`${o}%`,height:"100%",backgroundColor:n[t],transition:"width 0.5s ease"}})))}))),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"25px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)"}},(0,e.createElement)("h3",{style:{marginBottom:"20px",color:"#2C3E50",fontSize:"20px",fontWeight:"700"}},"🏆 Top Selling Items"),(0,e.createElement)("div",{style:{display:"grid",gap:"12px"}},m.length>0?m.map((t,r)=>(0,e.createElement)("div",{key:r,style:{padding:"15px",backgroundColor:"#F8F9FA",borderRadius:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"}},(0,e.createElement)("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},(0,e.createElement)("div",{style:{width:"36px",height:"36px",backgroundColor:0===r?"#FFD700":1===r?"#C0C0C0":2===r?"#CD7F32":"#E9ECEF",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"700",color:"white"}},r+1),(0,e.createElement)("div",null,(0,e.createElement)("div",{style:{fontWeight:"700",fontSize:"15px",color:"#2C3E50"}},t.name),(0,e.createElement)("div",{style:{fontSize:"13px",color:"#6C757D"}},t.quantity," sold"))),(0,e.createElement)("div",{style:{fontWeight:"800",fontSize:"18px",color:"#06A77D"}},"$",t.revenue.toFixed(2)))):(0,e.createElement)("div",{style:{textAlign:"center",color:"#6C757D",padding:"40px"}},"📭 No data available"))),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"25px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)"}},(0,e.createElement)("h3",{style:{marginBottom:"20px",color:"#2C3E50",fontSize:"20px",fontWeight:"700"}},"🪑 Top Tables by Revenue"),(0,e.createElement)("div",{style:{display:"grid",gap:"12px"}},y.length>0?y.map((t,r)=>(0,e.createElement)("div",{key:r,style:{padding:"15px",backgroundColor:"#F8F9FA",borderRadius:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"}},(0,e.createElement)("div",null,(0,e.createElement)("div",{style:{fontWeight:"700",fontSize:"15px",color:"#2C3E50"}},"🪑 Table ",t.table),(0,e.createElement)("div",{style:{fontSize:"13px",color:"#6C757D"}},t.orders," orders")),(0,e.createElement)("div",{style:{fontWeight:"800",fontSize:"18px",color:"#004E89"}},"$",t.revenue.toFixed(2)))):(0,e.createElement)("div",{style:{textAlign:"center",color:"#6C757D",padding:"40px"}},"📭 No data available")))))},n=document.getElementById("rms-reports-root");n&&(0,t.createRoot)(n).render((0,e.createElement)(r,null))})();