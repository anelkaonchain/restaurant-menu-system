(()=>{"use strict";const e=window.React,t=window.wp.element,o=function(){const[t,o]=(0,e.useState)([]),[r,n]=(0,e.useState)(!0),[a,l]=(0,e.useState)(null),[i,p]=(0,e.useState)(!1),[d,s]=(0,e.useState)("all"),[c,x]=(0,e.useState)("month"),u=[{value:"rent",label:"🏠 Rent",color:"#DC3545"},{value:"salary",label:"💼 Salary",color:"#FF6B35"},{value:"utilities",label:"💡 Utilities",color:"#FFC107"},{value:"supplies",label:"📦 Supplies",color:"#06A77D"},{value:"maintenance",label:"🔧 Maintenance",color:"#004E89"},{value:"marketing",label:"📢 Marketing",color:"#9C27B0"},{value:"tax",label:"📋 Tax",color:"#795548"},{value:"insurance",label:"🛡️ Insurance",color:"#607D8B"},{value:"other",label:"📌 Other",color:"#6C757D"}],[m,g]=(0,e.useState)({category:"supplies",amount:"",description:"",expense_date:(new Date).toISOString().split("T")[0],receipt_url:"",notes:""});(0,e.useEffect)(()=>{y()},[]);const y=async()=>{try{const e=new FormData;e.append("action","rms_get_expenses"),e.append("nonce",window.rmsAdmin.nonce);const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e}),r=await t.json();r.success&&o(r.data),n(!1)}catch(e){console.error("Error fetching expenses:",e),n(!1)}},E=()=>{g({category:"supplies",amount:"",description:"",expense_date:(new Date).toISOString().split("T")[0],receipt_url:"",notes:""}),l(null),p(!1)},b=(e=>{const t=new Date,o=new Date(t.getFullYear(),t.getMonth(),t.getDate());return e.filter(e=>{const t=new Date(e.expense_date);if("today"===c)return t>=o;if("week"===c){const e=new Date(o);return e.setDate(e.getDate()-7),t>=e}if("month"===c){const e=new Date(o);return e.setMonth(e.getMonth()-1),t>=e}if("year"===c){const e=new Date(o);return e.setFullYear(e.getFullYear()-1),t>=e}return!0})})(t).filter(e=>"all"===d||e.category===d),h=b.reduce((e,t)=>e+parseFloat(t.amount||0),0),f={};return u.forEach(e=>{f[e.value]=b.filter(t=>t.category===e.value).reduce((e,t)=>e+parseFloat(t.amount||0),0)}),r?(0,e.createElement)("div",{style:{padding:"60px 20px",textAlign:"center"}},(0,e.createElement)("div",{style:{display:"inline-block",width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #004E89",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,e.createElement)("p",{style:{marginTop:"20px",color:"#6C757D"}},"Loading Expenses..."),(0,e.createElement)("style",null,"@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }")):(0,e.createElement)("div",{style:{padding:"30px",maxWidth:"1400px",margin:"0 auto",backgroundColor:"#F8F9FA",minHeight:"100vh"}},(0,e.createElement)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",flexWrap:"wrap",gap:"15px"}},(0,e.createElement)("h1",{style:{margin:0,fontSize:"32px",fontWeight:"700",color:"#2C3E50"}},"💰 Expense Management"),(0,e.createElement)("button",{onClick:()=>p(!i),style:{padding:"12px 24px",backgroundColor:"#DC3545",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",fontSize:"15px",fontWeight:"700",boxShadow:"0 4px 12px rgba(220,53,69,0.3)"}},i?"✕ Cancel":"➕ Add Expense")),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"15px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"20px",display:"flex",gap:"15px",flexWrap:"wrap"}},["today","week","month","year","all"].map(t=>(0,e.createElement)("button",{key:t,onClick:()=>x(t),style:{padding:"10px 20px",backgroundColor:c===t?"#004E89":"white",color:c===t?"white":"#2C3E50",border:c===t?"none":"2px solid #E9ECEF",borderRadius:"10px",cursor:"pointer",fontSize:"15px",fontWeight:"600"}},"today"===t&&"📅 Today","week"===t&&"📆 Last 7 Days","month"===t&&"🗓️ Last 30 Days","year"===t&&"📈 Last Year","all"===t&&"🌍 All Time"))),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",marginBottom:"30px",borderLeft:"6px solid #DC3545"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"💸 Total Expenses"),(0,e.createElement)("div",{style:{fontSize:"36px",fontWeight:"800",color:"#DC3545"}},"$",h.toFixed(2))),i&&(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",marginBottom:"30px"}},(0,e.createElement)("h3",{style:{marginTop:0,color:"#2C3E50"}},a?"✏️ Edit Expense":"➕ Add New Expense"),(0,e.createElement)("form",{onSubmit:async e=>{e.preventDefault();const t=new FormData;t.append("action","rms_save_expense"),t.append("nonce",window.rmsAdmin.nonce),Object.keys(m).forEach(e=>{null!==m[e]&&void 0!==m[e]&&t.append(e,m[e])}),a&&t.append("id",a.id);try{const e=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:t}),o=await e.json();o.success?(y(),E(),alert("Expense saved successfully!")):alert("Error: "+(o.data||"Failed to save expense"))}catch(e){console.error("Error saving expense:",e),alert("Network error: "+e.message)}}},(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"}},(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Category *"),(0,e.createElement)("select",{required:!0,value:m.category,onChange:e=>g({...m,category:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}},u.map(t=>(0,e.createElement)("option",{key:t.value,value:t.value},t.label)))),(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Amount ($) *"),(0,e.createElement)("input",{type:"number",step:"0.01",required:!0,value:m.amount,onChange:e=>g({...m,amount:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}})),(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Date *"),(0,e.createElement)("input",{type:"date",required:!0,value:m.expense_date,onChange:e=>g({...m,expense_date:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}}))),(0,e.createElement)("div",{style:{marginTop:"20px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Description *"),(0,e.createElement)("input",{type:"text",required:!0,value:m.description,onChange:e=>g({...m,description:e.target.value}),placeholder:"e.g., Monthly office rent",style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}})),(0,e.createElement)("div",{style:{marginTop:"20px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Receipt URL (Optional)"),(0,e.createElement)("input",{type:"url",value:m.receipt_url,onChange:e=>g({...m,receipt_url:e.target.value}),placeholder:"https://...",style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}})),(0,e.createElement)("div",{style:{marginTop:"20px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Notes"),(0,e.createElement)("textarea",{value:m.notes,onChange:e=>g({...m,notes:e.target.value}),rows:"3",style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px",fontFamily:"inherit"}})),(0,e.createElement)("div",{style:{marginTop:"20px",display:"flex",gap:"10px"}},(0,e.createElement)("button",{type:"submit",style:{padding:"12px 24px",backgroundColor:"#06A77D",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",fontSize:"15px",fontWeight:"700"}},"💾 Save Expense"),(0,e.createElement)("button",{type:"button",onClick:E,style:{padding:"12px 24px",backgroundColor:"#6C757D",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",fontSize:"15px",fontWeight:"700"}},"Cancel")))),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"15px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"20px",display:"flex",gap:"10px",flexWrap:"wrap"}},(0,e.createElement)("button",{onClick:()=>s("all"),style:{padding:"10px 20px",backgroundColor:"all"===d?"#004E89":"white",color:"all"===d?"white":"#2C3E50",border:"all"===d?"none":"2px solid #E9ECEF",borderRadius:"10px",cursor:"pointer",fontSize:"14px",fontWeight:"600"}},"📊 All Categories"),u.map(t=>(0,e.createElement)("button",{key:t.value,onClick:()=>s(t.value),style:{padding:"10px 20px",backgroundColor:d===t.value?t.color:"white",color:d===t.value?"white":"#2C3E50",border:d===t.value?"none":"2px solid #E9ECEF",borderRadius:"10px",cursor:"pointer",fontSize:"14px",fontWeight:"600"}},t.label," $",f[t.value].toFixed(0)))),(0,e.createElement)("div",{style:{display:"grid",gap:"15px"}},0===b.length?(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"60px",textAlign:"center",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)"}},(0,e.createElement)("div",{style:{fontSize:"48px",marginBottom:"15px"}},"💰"),(0,e.createElement)("h3",{style:{color:"#6C757D"}},"No expenses found")):b.map(t=>{const o=(r=t.category,u.find(e=>e.value===r)||u[u.length-1]);var r;return(0,e.createElement)("div",{key:t.id,style:{backgroundColor:"white",borderRadius:"15px",padding:"20px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:`6px solid ${o.color}`,display:"flex",justifyContent:"space-between",alignItems:"center",gap:"20px",flexWrap:"wrap"}},(0,e.createElement)("div",{style:{flex:1,minWidth:"200px"}},(0,e.createElement)("div",{style:{display:"inline-block",padding:"6px 12px",backgroundColor:o.color,color:"white",borderRadius:"20px",fontSize:"13px",fontWeight:"700",marginBottom:"10px"}},o.label),(0,e.createElement)("h3",{style:{margin:"0 0 8px 0",color:"#2C3E50",fontSize:"18px"}},t.description),(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D"}},"📅 ",new Date(t.expense_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),t.notes&&(0,e.createElement)("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#F8F9FA",borderRadius:"6px",fontSize:"13px",color:"#6C757D"}},"📝 ",t.notes),t.receipt_url&&(0,e.createElement)("a",{href:t.receipt_url,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",marginTop:"10px",color:"#004E89",textDecoration:"none",fontSize:"13px",fontWeight:"600"}},"📎 View Receipt")),(0,e.createElement)("div",{style:{fontSize:"28px",fontWeight:"800",color:"#DC3545",minWidth:"120px",textAlign:"right"}},"$",parseFloat(t.amount).toFixed(2)),(0,e.createElement)("div",{style:{display:"flex",gap:"10px"}},(0,e.createElement)("button",{onClick:()=>(e=>{l(e),g({category:e.category,amount:e.amount,description:e.description,expense_date:e.expense_date,receipt_url:e.receipt_url||"",notes:e.notes||""}),p(!0)})(t),style:{padding:"10px 20px",backgroundColor:"#004E89",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"}},"✏️ Edit"),(0,e.createElement)("button",{onClick:()=>(async e=>{if(!confirm("Are you sure you want to delete this expense?"))return;const t=new FormData;t.append("action","rms_delete_expense"),t.append("nonce",window.rmsAdmin.nonce),t.append("id",e);try{const e=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:t});(await e.json()).success&&y()}catch(e){console.error("Error deleting expense:",e)}})(t.id),style:{padding:"10px 20px",backgroundColor:"#DC3545",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"}},"🗑️ Delete")))})))},r=document.getElementById("rms-expenses-root");r&&(0,t.createRoot)(r).render((0,e.createElement)(o,null))})();