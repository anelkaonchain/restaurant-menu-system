(()=>{"use strict";const e=window.React,t=window.wp.element,o=function(){const[t,o]=(0,e.useState)([]),[r,n]=(0,e.useState)(!0),[a,l]=(0,e.useState)(null),[i,d]=(0,e.useState)(!1),[p,s]=(0,e.useState)("all"),[c,m]=(0,e.useState)(""),[u,x]=(0,e.useState)({item_name:"",current_stock:"",min_stock:"",unit:"kg",supplier:"",last_order_date:"",notes:""});(0,e.useEffect)(()=>{g()},[]);const g=async()=>{try{const e=new FormData;e.append("action","rms_get_stocks"),e.append("nonce",window.rmsAdmin.nonce);const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e}),r=await t.json();r.success&&o(r.data),n(!1)}catch(e){console.error("Error fetching stocks:",e),n(!1)}},E=()=>{x({item_name:"",current_stock:"",min_stock:"",unit:"kg",supplier:"",last_order_date:"",notes:""}),l(null),d(!1)},b=(e,t)=>{const o=parseFloat(e),r=parseFloat(t);return 0===o?"out":o<=r?"low":o<=1.5*r?"medium":"good"},y=t.filter(e=>{const t=b(e.current_stock,e.min_stock),o="all"===p||t===p,r=e.item_name.toLowerCase().includes(c.toLowerCase())||e.supplier&&e.supplier.toLowerCase().includes(c.toLowerCase());return o&&r}),f={total:t.length,out:t.filter(e=>"out"===b(e.current_stock,e.min_stock)).length,low:t.filter(e=>"low"===b(e.current_stock,e.min_stock)).length,good:t.filter(e=>"good"===b(e.current_stock,e.min_stock)).length};return r?(0,e.createElement)("div",{style:{padding:"60px 20px",textAlign:"center"}},(0,e.createElement)("div",{style:{display:"inline-block",width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #004E89",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,e.createElement)("p",{style:{marginTop:"20px",color:"#6C757D"}},"Loading Stock..."),(0,e.createElement)("style",null,"@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }")):(0,e.createElement)("div",{style:{padding:"30px",maxWidth:"1400px",margin:"0 auto",backgroundColor:"#F8F9FA",minHeight:"100vh"}},(0,e.createElement)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",flexWrap:"wrap",gap:"15px"}},(0,e.createElement)("h1",{style:{margin:0,fontSize:"32px",fontWeight:"700",color:"#2C3E50"}},"üì¶ Stock Management"),(0,e.createElement)("button",{onClick:()=>d(!i),style:{padding:"12px 24px",backgroundColor:"#004E89",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",fontSize:"15px",fontWeight:"700",boxShadow:"0 4px 12px rgba(0,78,137,0.3)"}},i?"‚úï Cancel":"‚ûï Add Stock Item")),(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px",marginBottom:"30px"}},(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:"6px solid #004E89"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"üì¶ Total Items"),(0,e.createElement)("div",{style:{fontSize:"28px",fontWeight:"800",color:"#004E89"}},f.total)),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:"6px solid #DC3545"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"‚ö†Ô∏è Out of Stock"),(0,e.createElement)("div",{style:{fontSize:"28px",fontWeight:"800",color:"#DC3545"}},f.out)),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:"6px solid #FFC107"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"‚ö° Low Stock"),(0,e.createElement)("div",{style:{fontSize:"28px",fontWeight:"800",color:"#FFC107"}},f.low)),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:"6px solid #06A77D"}},(0,e.createElement)("div",{style:{fontSize:"14px",color:"#6C757D",marginBottom:"8px",fontWeight:"600"}},"‚úÖ Good Stock"),(0,e.createElement)("div",{style:{fontSize:"28px",fontWeight:"800",color:"#06A77D"}},f.good))),i&&(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",marginBottom:"30px"}},(0,e.createElement)("h3",{style:{marginTop:0,color:"#2C3E50"}},a?"‚úèÔ∏è Edit Stock Item":"‚ûï Add New Stock Item"),(0,e.createElement)("form",{onSubmit:async e=>{if(e.preventDefault(),console.log("Form submitted!"),console.log("Form data:",u),console.log("rmsAdmin:",window.rmsAdmin),!window.rmsAdmin||!window.rmsAdmin.ajaxUrl||!window.rmsAdmin.nonce)return void alert("Error: rmsAdmin not loaded. Please refresh the page.");const t=new FormData;t.append("action","rms_save_stock"),t.append("nonce",window.rmsAdmin.nonce),Object.keys(u).forEach(e=>{null!==u[e]&&void 0!==u[e]&&t.append(e,u[e])}),a&&t.append("id",a.id),console.log("Sending data to:",window.rmsAdmin.ajaxUrl);try{const e=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:t});console.log("Response status:",e.status);const o=await e.json();console.log("Response data:",o),o.success?(g(),E(),alert("Stock item saved successfully!")):alert("Error: "+(o.data||"Failed to save stock"))}catch(e){console.error("Error saving stock:",e),alert("Network error: "+e.message)}}},(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"}},(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Item Name *"),(0,e.createElement)("input",{type:"text",required:!0,value:u.item_name,onChange:e=>x({...u,item_name:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}})),(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Current Stock *"),(0,e.createElement)("input",{type:"number",step:"0.01",required:!0,value:u.current_stock,onChange:e=>x({...u,current_stock:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}})),(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Minimum Stock *"),(0,e.createElement)("input",{type:"number",step:"0.01",required:!0,value:u.min_stock,onChange:e=>x({...u,min_stock:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}})),(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Unit"),(0,e.createElement)("select",{value:u.unit,onChange:e=>x({...u,unit:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}},(0,e.createElement)("option",{value:"kg"},"kg"),(0,e.createElement)("option",{value:"g"},"g"),(0,e.createElement)("option",{value:"l"},"l"),(0,e.createElement)("option",{value:"ml"},"ml"),(0,e.createElement)("option",{value:"pcs"},"pieces"),(0,e.createElement)("option",{value:"box"},"box"),(0,e.createElement)("option",{value:"pack"},"pack"))),(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Supplier"),(0,e.createElement)("input",{type:"text",value:u.supplier,onChange:e=>x({...u,supplier:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}})),(0,e.createElement)("div",null,(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Last Order Date"),(0,e.createElement)("input",{type:"date",value:u.last_order_date,onChange:e=>x({...u,last_order_date:e.target.value}),style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}}))),(0,e.createElement)("div",{style:{marginTop:"20px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2C3E50"}},"Notes"),(0,e.createElement)("textarea",{value:u.notes,onChange:e=>x({...u,notes:e.target.value}),rows:"3",style:{width:"100%",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px",fontFamily:"inherit"}})),(0,e.createElement)("div",{style:{marginTop:"20px",display:"flex",gap:"10px"}},(0,e.createElement)("button",{type:"submit",style:{padding:"12px 24px",backgroundColor:"#06A77D",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",fontSize:"15px",fontWeight:"700"}},"üíæ Save Stock"),(0,e.createElement)("button",{type:"button",onClick:E,style:{padding:"12px 24px",backgroundColor:"#6C757D",color:"white",border:"none",borderRadius:"10px",cursor:"pointer",fontSize:"15px",fontWeight:"700"}},"Cancel")))),(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"15px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"20px",display:"flex",gap:"15px",flexWrap:"wrap",alignItems:"center"}},(0,e.createElement)("input",{type:"text",placeholder:"üîç Search items or suppliers...",value:c,onChange:e=>m(e.target.value),style:{flex:1,minWidth:"250px",padding:"10px",border:"2px solid #E9ECEF",borderRadius:"8px",fontSize:"15px"}}),(0,e.createElement)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"}},["all","out","low","good"].map(t=>(0,e.createElement)("button",{key:t,onClick:()=>s(t),style:{padding:"10px 20px",backgroundColor:p===t?"#004E89":"white",color:p===t?"white":"#2C3E50",border:p===t?"none":"2px solid #E9ECEF",borderRadius:"10px",cursor:"pointer",fontSize:"14px",fontWeight:"600"}},"all"===t&&"All","out"===t&&"‚ö†Ô∏è Out","low"===t&&"‚ö° Low","good"===t&&"‚úÖ Good")))),(0,e.createElement)("div",{style:{display:"grid",gap:"15px"}},0===y.length?(0,e.createElement)("div",{style:{backgroundColor:"white",padding:"60px",textAlign:"center",borderRadius:"15px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)"}},(0,e.createElement)("div",{style:{fontSize:"48px",marginBottom:"15px"}},"üì¶"),(0,e.createElement)("h3",{style:{color:"#6C757D"}},"No stock items found")):y.map(t=>{const o=b(t.current_stock,t.min_stock),r=(e=>({out:"#DC3545",low:"#FFC107",medium:"#FF6B35",good:"#06A77D"}[e]))(o);return(0,e.createElement)("div",{key:t.id,style:{backgroundColor:"white",borderRadius:"15px",padding:"20px",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",borderLeft:`6px solid ${r}`,display:"flex",justifyContent:"space-between",alignItems:"center",gap:"20px",flexWrap:"wrap"}},(0,e.createElement)("div",{style:{flex:1,minWidth:"200px"}},(0,e.createElement)("h3",{style:{margin:"0 0 10px 0",color:"#2C3E50",fontSize:"20px"}},t.item_name),(0,e.createElement)("div",{style:{display:"flex",flexWrap:"wrap",gap:"15px",fontSize:"14px",color:"#6C757D"}},(0,e.createElement)("div",null,(0,e.createElement)("strong",null,"Current:")," ",t.current_stock," ",t.unit),(0,e.createElement)("div",null,(0,e.createElement)("strong",null,"Min:")," ",t.min_stock," ",t.unit),t.supplier&&(0,e.createElement)("div",null,(0,e.createElement)("strong",null,"Supplier:")," ",t.supplier)),t.notes&&(0,e.createElement)("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:"#F8F9FA",borderRadius:"6px",fontSize:"13px",color:"#6C757D"}},"üìù ",t.notes)),(0,e.createElement)("div",{style:{padding:"10px 20px",backgroundColor:r,color:"white",borderRadius:"25px",fontWeight:"700",fontSize:"14px"}},(e=>({out:"Out of Stock",low:"Low Stock",medium:"Medium Stock",good:"Good Stock"}[e]))(o)),(0,e.createElement)("div",{style:{display:"flex",gap:"10px"}},(0,e.createElement)("button",{onClick:()=>(e=>{l(e),x({item_name:e.item_name,current_stock:e.current_stock,min_stock:e.min_stock,unit:e.unit,supplier:e.supplier||"",last_order_date:e.last_order_date||"",notes:e.notes||""}),d(!0)})(t),style:{padding:"10px 20px",backgroundColor:"#004E89",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"}},"‚úèÔ∏è Edit"),(0,e.createElement)("button",{onClick:()=>(async e=>{if(!confirm("Are you sure you want to delete this stock item?"))return;const t=new FormData;t.append("action","rms_delete_stock"),t.append("nonce",window.rmsAdmin.nonce),t.append("id",e);try{const e=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:t});(await e.json()).success&&g()}catch(e){console.error("Error deleting stock:",e)}})(t.id),style:{padding:"10px 20px",backgroundColor:"#DC3545",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"}},"üóëÔ∏è Delete")))})))},r=document.getElementById("rms-stock-root");r&&(0,t.createRoot)(r).render((0,e.createElement)(o,null))})();