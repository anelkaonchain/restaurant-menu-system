(()=>{"use strict";const e=window.React,t=window.wp.element,a=function({item:a,isCategory:r=!1,onClose:n}){const[o,i]=(0,t.useState)({}),[l,s]=(0,t.useState)({}),[d,c]=(0,t.useState)(""),[m,g]=(0,t.useState)({name:"",description:""}),[p,u]=(0,t.useState)(!1),[y,x]=(0,t.useState)({type:"",text:""});(0,t.useEffect)(()=>{b(),_()},[]),(0,t.useEffect)(()=>{if(y.text){const e=setTimeout(()=>{x({type:"",text:""})},3e3);return()=>clearTimeout(e)}},[y]);const b=async()=>{const e=new FormData;e.append("action","rms_get_languages");try{const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e}),a=await t.json();a.success&&i(a.data)}catch(e){console.error("Load languages error:",e)}},_=async()=>{const e=new FormData;e.append("action",r?"rms_get_category_translations":"rms_get_translations"),e.append("nonce",window.rmsAdmin.nonce),e.append(r?"category_id":"item_id",a.id);try{const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e}),a=await t.json();a.success&&s(a.data)}catch(e){console.error("Load translations error:",e)}};return(0,e.createElement)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px"}},(0,e.createElement)("div",{style:{background:"white",borderRadius:"12px",maxWidth:"900px",width:"100%",maxHeight:"90vh",overflow:"auto",padding:"30px"}},(0,e.createElement)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"}},(0,e.createElement)("h2",{style:{margin:0}},"Translations for: ",a.name),(0,e.createElement)("button",{onClick:n,style:{background:"none",border:"none",fontSize:"30px",cursor:"pointer",color:"#999"}},"×")),y.text&&(0,e.createElement)("div",{style:{padding:"12px 20px",marginBottom:"20px",borderRadius:"4px",background:"success"===y.type?"#d4edda":"#f8d7da",color:"success"===y.type?"#155724":"#721c24",border:"1px solid "+("success"===y.type?"#c3e6cb":"#f5c6cb")}},y.text),(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"20px"}},(0,e.createElement)("div",null,(0,e.createElement)("h3",null,"Languages"),(0,e.createElement)("div",{style:{maxHeight:"400px",overflow:"auto",border:"1px solid #ddd",borderRadius:"8px"}},Object.entries(o).map(([t,a])=>(0,e.createElement)("div",{key:t,onClick:()=>{return c(e=t),void(l[e]?g(r?{name:l[e],description:""}:{name:l[e].name,description:l[e].description}):g({name:"",description:""}));var e},style:{padding:"12px",cursor:"pointer",background:d===t?"#667eea":"white",color:d===t?"white":"#333",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"}},(0,e.createElement)("span",null,a," (",t,")"),l[t]&&(0,e.createElement)("span",{style:{background:d===t?"white":"#27ae60",color:d===t?"#667eea":"white",padding:"2px 8px",borderRadius:"10px",fontSize:"11px"}},"✓"))))),(0,e.createElement)("div",null,d?(0,e.createElement)(e.Fragment,null,(0,e.createElement)("h3",null,"Edit Translation (",o[d],")"),(0,e.createElement)("div",{style:{marginBottom:"15px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"}},"Name *"),(0,e.createElement)("input",{type:"text",className:"regular-text",value:m.name,onChange:e=>g({...m,name:e.target.value}),placeholder:"Translated name",style:{width:"100%",padding:"8px"}})),!r&&(0,e.createElement)("div",{style:{marginBottom:"15px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"}},"Description"),(0,e.createElement)("textarea",{className:"large-text",value:m.description,onChange:e=>g({...m,description:e.target.value}),placeholder:"Translated description",rows:"6",style:{width:"100%",padding:"8px"}})),(0,e.createElement)("div",{style:{background:"#f8f9fa",padding:"15px",borderRadius:"8px",marginBottom:"15px"}},(0,e.createElement)("strong",null,"Original (English):"),(0,e.createElement)("div",{style:{marginTop:"8px",color:"#666"}},(0,e.createElement)("div",null,(0,e.createElement)("strong",null,"Name:")," ",a.name),!r&&a.description&&(0,e.createElement)("div",{style:{marginTop:"5px"}},(0,e.createElement)("strong",null,"Description:")," ",a.description))),(0,e.createElement)("button",{className:"button button-primary",onClick:async()=>{if(!d)return void x({type:"error",text:"Please select a language"});if(!m.name.trim())return void x({type:"error",text:"Name is required"});u(!0);const e=new FormData;e.append("action",r?"rms_save_category_translation":"rms_save_translation"),e.append("nonce",window.rmsAdmin.nonce),e.append(r?"category_id":"item_id",a.id),e.append("language_code",d),e.append("name",m.name),r||e.append("description",m.description);try{const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e});(await t.json()).success?(x({type:"success",text:"Translation saved!"}),await _(),c(""),g({name:"",description:""})):x({type:"error",text:"Failed to save translation"})}catch(e){console.error("Save error:",e),x({type:"error",text:"Error saving translation"})}u(!1)},disabled:p,style:{width:"100%"}},p?"Saving...":"Save Translation")):(0,e.createElement)("div",{style:{padding:"40px",textAlign:"center",color:"#999"}},"← Select a language to add or edit translation")))))},r={en:{common:{add_new:"Add New",edit:"Edit",delete:"Delete",save:"Save",saving:"Saving...",cancel:"Cancel",loading:"Loading...",name:"Name",description:"Description",price:"Price",actions:"Actions",translate:"Translate"},menu_items:{title:"Restaurant Menu",add_new_item:"Add New Item",item_name:"Item Name",item_price:"Price ($)",allergens:"Allergens",category:"Category",select_category:"Select a category",item_image:"Item Image",remove_image:"Remove Image"},categories:{title:"Menu Categories",add_new_category:"Add New Category",category_name:"Category Name",slug:"Slug",count:"Count",items:"items",no_categories:"No categories yet. Click 'Add New Category' to create one.",name_required:"Category name is required",save_success:"Category saved successfully!",save_error:"Failed to save category",delete_confirm:"Are you sure you want to delete this category?",delete_success:"Category deleted successfully!",delete_error:"Failed to delete category",load_error:"Failed to load categories"},orders:{title:"Orders",all:"All",pending:"Pending",preparing:"Preparing",ready:"Ready",delivered:"Delivered",cancelled:"Cancelled",order:"Order",table:"Table",customer_name:"Customer Name",items:"Items",notes:"Notes",total:"Total",start_preparing:"Start Preparing",mark_ready:"Mark Ready",mark_delivered:"Mark Delivered",confirm_delete:"Are you sure?",no_orders:"No orders found"},qrcodes:{title:"QR Codes",add_new_table:"Add New Table",table_number:"Table Number"},settings:{title:"Settings",application_language:"Application Language",admin_panel_language:"Admin Panel Language"}},tr:{common:{add_new:"Yeni Ekle",edit:"Düzenle",delete:"Sil",save:"Kaydet",saving:"Kaydediliyor...",cancel:"İptal",loading:"Yükleniyor...",name:"İsim",description:"Açıklama",price:"Fiyat",actions:"İşlemler",translate:"Çevir"},menu_items:{title:"Restoran Menüsü",add_new_item:"Yeni Ürün Ekle",item_name:"Ürün Adı",item_price:"Fiyat ($)",allergens:"Alerjenler",category:"Kategori",select_category:"Bir kategori seçin",item_image:"Ürün Görseli",remove_image:"Görseli Kaldır"},categories:{title:"Menü Kategorileri",add_new_category:"Yeni Kategori Ekle",category_name:"Kategori Adı",slug:"Slug",count:"Adet",items:"ürün",no_categories:"Henüz kategori yok. 'Yeni Kategori Ekle' butonuna tıklayın.",name_required:"Kategori adı gereklidir",save_success:"Kategori başarıyla kaydedildi!",save_error:"Kategori kaydedilemedi",delete_confirm:"Bu kategoriyi silmek istediğinizden emin misiniz?",delete_success:"Kategori başarıyla silindi!",delete_error:"Kategori silinemedi",load_error:"Kategoriler yüklenemedi"},orders:{title:"Siparişler",all:"Tümü",pending:"Bekliyor",preparing:"Hazırlanıyor",ready:"Hazır",delivered:"Teslim Edildi",cancelled:"İptal Edildi",order:"Sipariş",table:"Masa",customer_name:"Müşteri Adı",items:"Ürünler",notes:"Notlar",total:"Toplam",start_preparing:"Hazırlamaya Başla",mark_ready:"Hazır Olarak İşaretle",mark_delivered:"Teslim Edildi Olarak İşaretle",confirm_delete:"Emin misiniz?",no_orders:"Sipariş bulunamadı"},qrcodes:{title:"QR Kodları",add_new_table:"Yeni Masa Ekle",table_number:"Masa Numarası"},settings:{title:"Ayarlar",application_language:"Uygulama Dili",admin_panel_language:"Yönetim Paneli Dili"}}};const n=function(){const{t:n}=function(){const[e,a]=(0,t.useState)("en");(0,t.useEffect)(()=>{n()},[]);const n=async()=>{try{const e=new FormData;e.append("action","rms_get_settings"),e.append("nonce",window.rmsAdmin.nonce);const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e}),r=await t.json();r.success&&r.data.admin_language&&a(r.data.admin_language)}catch(e){console.error("Failed to load language:",e)}};return{t:t=>{const a=t.split(".");let n=r[e];for(const e of a){if(!n||!n[e]){n=r.en;for(const e of a){if(!n||!n[e])return t;n=n[e]}return n}n=n[e]}return n},language:e}}(),[o,i]=(0,t.useState)([]),[l,s]=(0,t.useState)(!1),[d,c]=(0,t.useState)(!1),[m,g]=(0,t.useState)(null),[p,u]=(0,t.useState)(null),[y,x]=(0,t.useState)(null),[b,_]=(0,t.useState)({name:"",slug:""}),[f,w]=(0,t.useState)({type:"",text:""});(0,t.useEffect)(()=>{E()},[]),(0,t.useEffect)(()=>{if(f.text){const e=setTimeout(()=>{w({type:"",text:""})},3e3);return()=>clearTimeout(e)}},[f]);const E=async()=>{s(!0);const e=new FormData;e.append("action","rms_get_categories"),e.append("nonce",window.rmsAdmin.nonce);try{const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e}),a=await t.json();if(a.success){const e=a.data.sort((e,t)=>(e.display_order||0)-(t.display_order||0));i(e)}else console.error("Failed to load categories:",a)}catch(e){console.error("Load error:",e),w({type:"error",text:n("categories.load_error")})}s(!1)},v=async e=>{e.currentTarget.style.opacity="1",x(null);const t=o.map(e=>e.id),a=new FormData;a.append("action","rms_update_category_order"),a.append("nonce",window.rmsAdmin.nonce),a.append("categories",JSON.stringify(t));try{const e=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:a});(await e.json()).success?(w({type:"success",text:"Category order updated!"}),await E()):w({type:"error",text:"Failed to update order"})}catch(e){console.error("Error updating order:",e),w({type:"error",text:"Error updating order"})}};return(0,e.createElement)("div",{style:{maxWidth:"1200px",margin:"20px auto",padding:"0 20px"}},(0,e.createElement)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"}},(0,e.createElement)("h1",{style:{margin:0}},n("categories.title")),!d&&(0,e.createElement)("button",{className:"button button-primary",onClick:()=>c(!0),disabled:l},n("categories.add_new_category"))),f.text&&(0,e.createElement)("div",{style:{padding:"12px 20px",marginBottom:"20px",borderRadius:"4px",background:"success"===f.type?"#d4edda":"#f8d7da",color:"success"===f.type?"#155724":"#721c24",border:"1px solid "+("success"===f.type?"#c3e6cb":"#f5c6cb")}},f.text),o.length>0&&!d&&(0,e.createElement)("div",{style:{padding:"12px 20px",marginBottom:"20px",borderRadius:"4px",background:"#e7f3ff",color:"#004085",border:"1px solid #b8daff",fontSize:"14px"}},"💡 ",(0,e.createElement)("strong",null,"Tip:")," Drag and drop rows to reorder categories. This order will be reflected in the menu."),d&&(0,e.createElement)("div",{style:{background:"white",padding:"25px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"30px"}},(0,e.createElement)("h2",{style:{marginTop:0}},m?n("common.edit")+" "+n("categories.title"):n("categories.add_new_category")),(0,e.createElement)("div",{style:{marginBottom:"20px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold"}},n("categories.category_name")," *"),(0,e.createElement)("input",{type:"text",className:"regular-text",value:b.name,onChange:e=>_({...b,name:e.target.value}),placeholder:n("categories.category_name"),style:{width:"100%",padding:"8px"}})),(0,e.createElement)("div",{style:{marginBottom:"20px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold"}},n("categories.slug")),(0,e.createElement)("input",{type:"text",className:"regular-text",value:b.slug,onChange:e=>_({...b,slug:e.target.value}),placeholder:n("categories.slug"),style:{width:"100%",padding:"8px"}}),(0,e.createElement)("p",{style:{fontSize:"12px",color:"#666",marginTop:"5px"}},"Leave empty to auto-generate from name")),(0,e.createElement)("div",{style:{display:"flex",gap:"10px"}},(0,e.createElement)("button",{className:"button button-primary",onClick:async()=>{if(!b.name.trim())return void w({type:"error",text:n("categories.name_required")});s(!0);const e=new FormData;e.append("action","rms_save_category"),e.append("nonce",window.rmsAdmin.nonce),e.append("name",b.name),e.append("slug",b.slug),m&&e.append("id",m);try{const t=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:e}),a=await t.json();a.success?(w({type:"success",text:n("categories.save_success")}),c(!1),_({name:"",slug:""}),g(null),await E()):w({type:"error",text:a.data||n("categories.save_error")})}catch(e){console.error("Save error:",e),w({type:"error",text:n("categories.save_error")})}s(!1)},disabled:l},n(l?"common.saving":"common.save")),(0,e.createElement)("button",{className:"button",onClick:()=>{c(!1),g(null),_({name:"",slug:""})},disabled:l},n("common.cancel")))),(0,e.createElement)("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden"}},l&&0===o.length?(0,e.createElement)("div",{style:{padding:"40px",textAlign:"center",color:"#666"}},n("common.loading"),"..."):0===o.length?(0,e.createElement)("div",{style:{padding:"40px",textAlign:"center",color:"#666"}},n("categories.no_categories")):(0,e.createElement)("table",{style:{width:"100%",borderCollapse:"collapse"}},(0,e.createElement)("thead",null,(0,e.createElement)("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #dee2e6"}},(0,e.createElement)("th",{style:{padding:"15px",textAlign:"left",fontWeight:"bold",width:"40px"}}),(0,e.createElement)("th",{style:{padding:"15px",textAlign:"left",fontWeight:"bold"}},n("common.name")),(0,e.createElement)("th",{style:{padding:"15px",textAlign:"left",fontWeight:"bold"}},n("categories.slug")),(0,e.createElement)("th",{style:{padding:"15px",textAlign:"center",fontWeight:"bold"}},n("categories.count")),(0,e.createElement)("th",{style:{padding:"15px",textAlign:"center",fontWeight:"bold"}},n("common.actions")))),(0,e.createElement)("tbody",null,o.map((t,a)=>(0,e.createElement)("tr",{key:t.id,draggable:!0,onDragStart:e=>((e,t)=>{x(t),e.dataTransfer.effectAllowed="move",e.currentTarget.style.opacity="0.5"})(e,a),onDragOver:e=>((e,t)=>{if(e.preventDefault(),null===y||y===t)return;const a=[...o],r=a[y];a.splice(y,1),a.splice(t,0,r),x(t),i(a)})(e,a),onDragEnd:v,style:{borderBottom:"1px solid #dee2e6",cursor:"move",backgroundColor:y===a?"#f0f0f0":"transparent",transition:"background-color 0.2s"}},(0,e.createElement)("td",{style:{padding:"15px",textAlign:"center"}},(0,e.createElement)("span",{style:{color:"#999",cursor:"grab",fontSize:"20px",userSelect:"none"}},"⋮⋮")),(0,e.createElement)("td",{style:{padding:"15px"}},(0,e.createElement)("strong",null,t.name)),(0,e.createElement)("td",{style:{padding:"15px",color:"#666",fontFamily:"monospace"}},t.slug),(0,e.createElement)("td",{style:{padding:"15px",textAlign:"center"}},(0,e.createElement)("span",{style:{background:"#e3f2fd",color:"#1976d2",padding:"4px 12px",borderRadius:"12px",fontSize:"13px",fontWeight:"bold"}},t.count," ",n("categories.items"))),(0,e.createElement)("td",{style:{padding:"15px",textAlign:"center"}},(0,e.createElement)("div",{style:{display:"flex",gap:"8px",justifyContent:"center"}},(0,e.createElement)("button",{className:"button button-small",onClick:()=>(e=>{g(e.id),_({name:e.name,slug:e.slug}),c(!0)})(t),disabled:l},n("common.edit")),(0,e.createElement)("button",{className:"button button-small",onClick:()=>u(t),disabled:l,style:{background:"#667eea",color:"white"}},"🌍 ",n("common.translate")),(0,e.createElement)("button",{className:"button button-small button-link-delete",onClick:()=>(async e=>{if(!confirm(n("categories.delete_confirm")))return;s(!0);const t=new FormData;t.append("action","rms_delete_category"),t.append("nonce",window.rmsAdmin.nonce),t.append("id",e);try{const e=await fetch(window.rmsAdmin.ajaxUrl,{method:"POST",body:t});(await e.json()).success?(w({type:"success",text:n("categories.delete_success")}),await E()):w({type:"error",text:n("categories.delete_error")})}catch(e){console.error("Delete error:",e),w({type:"error",text:n("categories.delete_error")})}s(!1)})(t.id),disabled:l,style:{color:"#b32d2e"}},n("common.delete"))))))))),p&&(0,e.createElement)(a,{item:p,isCategory:!0,onClose:()=>u(null)}))},o=document.getElementById("rms-categories-root");o&&(0,t.createRoot)(o).render((0,e.createElement)(n,null))})();